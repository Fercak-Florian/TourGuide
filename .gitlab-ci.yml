workflow:
  rules:
    - if: $CI_COMMIT_TAG
      when: never
    - if: $CI_COMMIT_BRANCH == 'develop'

# name of the Docker image, the Docker executor uses to run CI/CD jobs
image: openjdk:16-alpine

# Stages, which define when to run the jobs. For example, stages that run tests after stages that compile the code.
stages:
  - Build
  - Test
    
# build job in Build stage
build:
  stage: Build
  script:
    - cd TourGuide
    - sh ./gradlew assemble
# The paths keyword determines which files to add to the job artifacts. All paths to files and directories are relative to the repository where the job was created.
  artifacts:
    paths:
      - TourGuide/build/libs/*.jar
      - TourGuide/build/jacocoHtml/index.html
    
# test job in Test stage
test:
  stage: Test
  script:
  - cd TourGuide
  - sh ./gradlew check